Index: run.sh
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>#!/bin/bash\ncd /mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM_github\nexport PYTHONPATH=/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM_github\nmkdir -p /root/.cache/torch/hub/checkpoints\nln -s /mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/ckpt/* /root/.cache/torch/hub/checkpoints\n#pip install /mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/software/pyrosetta-2024.42+release.3366cf78a3-cp38-cp38-linux_x86_64.whl\n# 定义文件路径\nfasta_masked_dir=\"/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/examples/inversefold\"\n#fasta_masked_dir=\"/mnt/ai4x_ceph/fandiwu/buddy1/yidongsong/Ab_Ag_affinity/Wet_Experiment/data/af3_ppi\"\n#pdb_file=\"/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/examples/small2big/Nb2Ab/pdb.files.native/antigen.pdb\"\n#epitope_file=\"/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/examples/small2big/mC345c_hC3Nb_H_NA_A.pdb\"\n#alphfold3_dir=\"/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/diffpd/test/pdb/pdb.af3\"\n\n\n#ids=(hC3Nb_hudiff-1 hC3Nb_hudiff-2 hC3Nb_hudiff-3 hC3Nb_hudiff-4 hC3Nb_hudiff-5 hC3Nb_xu-1 hC3Nb_xu-2 hC3Nb_xu-3 hC3Nb_xu-4 hC3Nb_xu-5 hC3Nb-1 hC3Nb-2 hC3Nb-3)\n#ids=(hC3Nb_hudiff-mu-1 hC3Nb_hudiff-mu-2 hC3Nb_hudiff-mu-3 hC3Nb_hudiff-mu-4 hC3Nb_xu-mu-1 hC3Nb_xu-mu-2 hC3Nb_xu-mu-3 hC3Nb_xu-mu-4 hC3Nb-mu-1 hC3Nb-mu-2)\n#shuffled_ids=($(shuf -e \"${ids[@]}\"))\n#\n## 遍历随机打乱后的 ID 列表\n#for fasta_id in \"${shuffled_ids[@]}\"; do\n#[\"CD40\"]=\"6pe8_A_B_U\"\n#[\"IL36R\"]=\"6u6u_H_L_R\"\n#[\"C5\"]=\"5i5k_H_L_B\"\n#[\"TSLP\"]=\"5j13_C_B_A\"\n#[\"IL17A\"]=\"6ppg_B_A_G\"\n#[\"FXI\"]=\"6hhc_H_L_A\"\n#[\"ACVR2B\"]=\"5ngv_H_L_A\"\n#[\"TNFRSF9\"]=\"6a3w_A_B_C\"\n\ndeclare -A pdb_ids\npdb_ids=(\n    [\"CD40_h1\"]=\"6pe8_A_B_U_h_cdr1\"\n    [\"CD40_h2\"]=\"66pe8_A_B_U_h_cdr2\"\n    [\"CD40_h3\"]=\"6pe8_A_B_U_h_cdr3\"\n    [\"CD40_l1\"]=\"6pe8_A_B_U_l_cdr1\"\n    [\"CD40_l2\"]=\"6pe8_A_B_U_l_cdr2\"\n    [\"CD40_l3\"]=\"6pe8_A_B_U_l_cdr3\"\n    [\"IL36R_h1\"]=\"6u6u_H_L_R_h_cdr1\"\n    [\"IL36R_h2\"]=\"6u6u_H_L_R_h_cdr2\"\n    [\"IL36R_h3\"]=\"6u6u_H_L_R_h_cdr3\"\n    [\"IL36R_l1\"]=\"6u6u_H_L_R_l_cdr1\"\n    [\"IL36R_l2\"]=\"6u6u_H_L_R_l_cdr2\"\n    [\"IL36R_l3\"]=\"6u6u_H_L_R_l_cdr3\"\n    [\"C5_h1\"]=\"5i5k_H_L_B_h_cdr1\"\n    [\"C5_h2\"]=\"5i5k_H_L_B_h_cdr2\"\n    [\"C5_h3\"]=\"5i5k_H_L_B_h_cdr3\"\n    [\"C5_l1\"]=\"5i5k_H_L_B_l_cdr1\"\n    [\"C5_l2\"]=\"5i5k_H_L_B_l_cdr2\"\n    [\"C5_l3\"]=\"5i5k_H_L_B_l_cdr3\"\n    [\"TSLP_h1\"]=\"5j13_C_B_A_h_cdr1\"\n    [\"TSLP_h2\"]=\"5j13_C_B_A_h_cdr2\"\n    [\"TSLP_h3\"]=\"5j13_C_B_A_h_cdr3\"\n    [\"TSLP_l1\"]=\"5j13_C_B_A_l_cdr1\"\n    [\"TSLP_l2\"]=\"5j13_C_B_A_l_cdr2\"\n    [\"TSLP_l3\"]=\"5j13_C_B_A_l_cdr3\"\n    [\"IL17A_h1\"]=\"6ppg_B_A_G_h_cdr1\"\n    [\"IL17A_h2\"]=\"6ppg_B_A_G_h_cdr2\"\n    [\"IL17A_h3\"]=\"6ppg_B_A_G_h_cdr3\"\n    [\"IL17A_l1\"]=\"6ppg_B_A_G_l_cdr1\"\n    [\"IL17A_l2\"]=\"6ppg_B_A_G_l_cdr2\"\n    [\"IL17A_l3\"]=\"6ppg_B_A_G_l_cdr3\"\n    [\"FXI_h1\"]=\"6hhc_H_L_A_h_cdr1\"\n    [\"FXI_h2\"]=\"6hhc_H_L_A_h_cdr2\"\n    [\"FXI_h3\"]=\"6hhc_H_L_A_h_cdr3\"\n    [\"FXI_l1\"]=\"6hhc_H_L_A_l_cdr1\"\n    [\"FXI_l2\"]=\"6hhc_H_L_A_l_cdr2\"\n    [\"FXI_l3\"]=\"6hhc_H_L_A_l_cdr3\"\n    [\"ACVR2B_h1\"]=\"5ngv_H_L_A_h_cdr1\"\n    [\"ACVR2B_h2\"]=\"5ngv_H_L_A_h_cdr2\"\n    [\"ACVR2B_h3\"]=\"5ngv_H_L_A_h_cdr3\"\n    [\"ACVR2B_l1\"]=\"5ngv_H_L_A_l_cdr1\"\n    [\"ACVR2B_l2\"]=\"5ngv_H_L_A_l_cdr2\"\n    [\"ACVR2B_l3\"]=\"5ngv_H_L_A_l_cdr3\"\n    [\"TNFRSF9_h1\"]=\"6a3w_A_B_C_h_cdr1\"\n    [\"TNFRSF9_h2\"]=\"6a3w_A_B_C_h_cdr2\"\n    [\"TNFRSF9_h3\"]=\"6a3w_A_B_C_h_cdr3\"\n    [\"TNFRSF9_l1\"]=\"6a3w_A_B_C_l_cdr1\"\n    [\"TNFRSF9_l2\"]=\"6a3w_A_B_C_l_cdr2\"\n    [\"TNFRSF9_l3\"]=\"6a3w_A_B_C_l_cdr3\"\n)\n#6pe8_A_B_U\n#6u6u_H_L_R\n#5i5k_H_L_B\n#5j13_C_B_A\n#6ppg_B_A_G\n#6hhc_H_L_A\n#5ngv_H_L_A\n#6a3w_A_B_C\n\n\ndeclare -A epitopes\nepitopes=(\n    [\"Delta\"]='80 81 82 83 86 87 121 122 123 124 125 126 127 139 140 141 142 143 144 152 153 154 155'\n    [\"Alpha\"]='95 96 97 98 101 102 136 137 138 139 140 141 142 154 155 156 157 158 159 167 168 169 170 174'\n    [\"Beta\"]=\"342 442 443 444 445 446 448 466 479 480 481 486 488 489 490 491 492\"\n    [\"Kappa\"]='409 410 411 412 415 416 450 451 452 453 454 455 456 468 469 470 471 472 473 481 482 483 484'\n    [\"Lambda\"]='413 414 415 416 419 420 454 455 456 457 458 459 460 472 473 474 475 476 477 485 486 487 488'\n    [\"BA.1\"]='410 411 412 413 416 417 451 452 453 454 455 456 457 469 470 471 472 473 474 482 483 484 485'\n    [\"BA4_BA5\"]='79 80 81 82 85 86 120 121 122 123 124 125 126 138 139 140 141 142 143 151 152 153 154'\n    [\"BF.7\"]='113 114 115 116 119 120 154 155 156 157 158 159 160 172 173 174 175 176 177 185 186 187 188'\n    [\"BQ.1.1\"]='80 81 82 83 86 87 121 122 123 124 125 126 127 139 140 141 142 143 144 152 153 154 155'\n    [\"XBB\"]='420 421 422 423 426 427 461 462 463 464 465 466 467 479 480 481 482 483 484 492 493 494 495'\n    [\"WT-L452R\"]='90 91 92 93 96 97 131 132 133 134 135 136 137 149 150 151 152 153 154 162 163 164 165'\n)\n\n# 获取所有键并随机打乱\nstrains=(${!pdb_ids[@]})\nshuffled_strains=($(printf \"%s\\n\" \"${strains[@]}\" | shuf))\n\n# 使用随机打乱后的顺序处理\nfor strain in \"${shuffled_strains[@]}\"; do\n    pdb_id=\"${pdb_ids[$strain]}\"\n#    epitope=\"${epitopes[$strain]}\"\n#    echo \"$strain: PDB=$pdb_id, Epitope=$epitope\"\n    pdb_file=\"/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/examples/inversefold/pdb.files.native/$pdb_id.pdb\"\n    fasta_masked_file=\"/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/examples/inversefold/fasta.files.design/$pdb_id.fasta\"\n    output=\"/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/output/inversefold/$strain\"\n\n    # for one point\n  (CUDA_VISIBLE_DEVICES=0 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n  (CUDA_VISIBLE_DEVICES=1 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n  (CUDA_VISIBLE_DEVICES=2 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n  (CUDA_VISIBLE_DEVICES=3 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n  (CUDA_VISIBLE_DEVICES=4 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n  (CUDA_VISIBLE_DEVICES=5 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n  (CUDA_VISIBLE_DEVICES=6 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n  (CUDA_VISIBLE_DEVICES=7 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &\n\n\n  # 等待所有后台任务完成\n  wait\n\n  #else\n  #  echo \"文件 $fasta_file 不存在\"\n  #fi\ndone\n\necho \"所有后台任务已完成\"\n\n\n\n\n#Delta：https://www.rcsb.org/structure/7X7D\n#Alpha: https://www.rcsb.org/structure/7NEG\n#Beta: https://www.rcsb.org/structure/7ZR8\n#Kappa: https://www.rcsb.org/structure/7ZR8\n#Lambda: https://www.rcsb.org/structure/8VYG\n#BA.1 : https://www.rcsb.org/structure/7WRZ\n#BA4/BA5: https://www.rcsb.org/structure/7WRZ\n#BF.7: https://www.rcsb.org/structure/8XZD\n#BQ.1.1: https://www.rcsb.org/structure/8XYG\n#XBB: https://www.rcsb.org/structure/8I4E\n#WT-L452R: https://www.rcsb.org/structure/7ORB\n
===================================================================
diff --git a/run.sh b/run.sh
--- a/run.sh	(revision fdb989599891e9554446c6ccef8df0eab5c0f138)
+++ b/run.sh	(date 1740377269640)
@@ -114,17 +114,17 @@
 #    echo "$strain: PDB=$pdb_id, Epitope=$epitope"
     pdb_file="/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/examples/inversefold/pdb.files.native/$pdb_id.pdb"
     fasta_masked_file="/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/examples/inversefold/fasta.files.design/$pdb_id.fasta"
-    output="/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/output/inversefold/$strain"
+    output="/mnt/ai4x_ceph/fandiwu/buddy1/wangrubo/project/IgGM/output/inversefold_old/$strain"
 
     # for one point
-  (CUDA_VISIBLE_DEVICES=0 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
-  (CUDA_VISIBLE_DEVICES=1 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
-  (CUDA_VISIBLE_DEVICES=2 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
-  (CUDA_VISIBLE_DEVICES=3 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
-  (CUDA_VISIBLE_DEVICES=4 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
-  (CUDA_VISIBLE_DEVICES=5 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
-  (CUDA_VISIBLE_DEVICES=6 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
-  (CUDA_VISIBLE_DEVICES=7 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 100 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=0 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=1 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=2 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=3 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=4 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=5 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=6 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
+  (CUDA_VISIBLE_DEVICES=7 python design.py -f $fasta_masked_file -ag $pdb_file --output $output -ns 1 -rt inverse_design) &
 
 
   # 等待所有后台任务完成
